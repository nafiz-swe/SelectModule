<!DOCTYPE html>
<html>
<head>
  <title>ЁЯФФ Alarm Monitor - {{ level|upper }}</title>
</head>
<body>
  <h2>ЁЯУб Watching for "Select Module" in {{ level|upper }}...</h2>
  <p>ржпржЦржи рж╕ржарж┐ржХ рж▓рзЗржЦрж╛ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржмрзЗ, рждржЦржи ржЕрзНржпрж╛рж▓рж╛рж░рзНржо ржмрж╛ржЬржмрзЗ ржПржмржВ ржирждрзБржи ржкрзЗржЬ ржЦрзБрж▓ржмрзЗред</p>

  <audio id="alarmAudio" src="{{ url_for('static', filename='alarm.mp3') }}" preload="auto"></audio>

  <script>
    const level = "{{ level }}";
    let alarmTriggered = false;

    function checkAudioTrigger() {
      if (alarmTriggered) return;
      fetch(`/check-audio/${level}`)
        .then(res => res.json())
        .then(data => {
          if (data.play) {
            alarmTriggered = true;
            const audio = document.getElementById('alarmAudio');
            audio.play();
            // ржирждрзБржи ржЯрзНржпрж╛ржм ржЦрзБрж▓ржмрзЗ
            window.open("{{ TARGET_URLS[level] }}", "_blank");
            window.open("/alarm", "_blank");
            console.log("ЁЯФФ Alarm playing and pages opened");
          }
        });
    }

    setInterval(checkAudioTrigger, 3000);
  </script>
</body>
</html>
